<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>St. Sebastian's Church Raffle</title>
<!-- Google Fonts & Icons -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;600;700;800&display=swap" rel="stylesheet" />
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
<style>
  /* Basic styling omitted for brevity: same as previous, include your CSS here */
  /* ... (use the previous CSS code provided) ... */

  /* Add styles for the Reset button */
  #resetBtn {
    display: none;
    margin-top: 20px;
    padding: 12px 24px;
    background: linear-gradient(135deg, #f7971e, #f5576c);
    color: #fff;
    border: none;
    border-radius: 12px;
    font-size: 1.2rem;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    transition: all 0.3s ease;
  }
  #resetBtn:hover {
    box-shadow: 0 6px 16px rgba(0,0,0,0.3);
    transform: translateY(-2px);
  }
</style>
</head>
<body>
<div class="container">
  <!-- Header omitted for brevity -->
  <!-- Main grid -->
  <main>
    <!-- Raffle Draw Section -->
    <section class="section-box raffle-box">
      <h2 style="text-align: center;">Raffle Draw</h2>
      <div class="balls-container">
        <div class="ball" id="ball1" style="background: linear-gradient(135deg, #f7971e, #ffd200);"><div class="inner-text">üé≤</div></div>
        <div class="ball" id="ball2" style="background: linear-gradient(135deg, #6a11cb, #2575fc);"><div class="inner-text">üé≤</div></div>
        <div class="ball" id="ball3" style="background: linear-gradient(135deg, #43cea2, #185a9d);"><div class="inner-text">üé≤</div></div>
      </div>
      <div style="text-align:center;">
        <button id="drawBtn" class="draw-btn">Generate Next Winner</button>
        <button id="resetBtn">Reset</button>
      </div>
    </section>

    <!-- Winners Section -->
    <section class="section-box winners-box" id="winnersSection">
      <h2 style="text-align: center;">üèÜ Winners</h2>
      <div style="text-align:center; font-style:italic; color:#999; padding:20px;">Winners will appear here after each draw</div>
      <div id="winnersList"></div>
      <div id="congrats" style="display:none; margin-top:20px;">üéâ Congratulations! Contact the church office.</div>
    </section>
  </main>
</div>
<!-- Confetti container -->
<div id="confettiContainer"></div>
<!-- Footer omitted for brevity -->
<!-- JavaScript -->
<script>
  const positions = {
    'first': { emoji: 'ü•á', text: '1st Place' },
    'second': { emoji: 'ü•à', text: '2nd Place' },
    'third': { emoji: 'ü•â', text: '3rd Place' }
  };

  const STEP_3RD=0; const STEP_2ND=1; const STEP_1ST=2; 
  let currentStep=STEP_3RD;
  let availableNumbers=[];
  let winnersData=["001","002","003","004","005","006","007","008","009","010",
                   "011","012","013","014","015","016","017","018","019","020",
                   "021","022","023","024","025"];

  let isDrawing=false;

  // Initialize
  function initDraw() {
    currentStep=STEP_3RD;
    availableNumbers=[...winnersData];
    document.querySelectorAll('.ball').forEach(b=> {
      b.innerHTML='<div class="inner-text">üé≤</div>';
      b.dataset.winnerNumber='';
    });
    document.getElementById('winnersList').innerHTML='';
    document.getElementById('congrats').style.display='none';

    document.getElementById('winnersSection').style.opacity=0;
    document.getElementById('winnersSection').style.transform='translateY(20px)';
    document.getElementById('winnersSection').classList.remove('show');

    document.getElementById('drawBtn').disabled=false;
    document.getElementById('drawBtn').style.display='inline-block';
    document.getElementById('resetBtn').style.display='none';
  }

  function showWinnersSection() {
    const section=document.getElementById('winnersSection');
    section.style.opacity=1;
    section.style.transform='translateY(0)';
    section.classList.add('show');
  }

  async function spinBall(ball,winnerNumber) {
    return new Promise((resolve)=>{
      ball.classList.add('spinning');
      let count=0;
      const interval=setInterval(()=>{
        const randIdx=Math.floor(Math.random()*availableNumbers.length);
        ball.innerHTML='<div class="inner-text">'+availableNumbers[randIdx]+'</div>';
        count++;
        if (count>20) {
          clearInterval(interval);
          ball.innerHTML='<div class="inner-text">'+winnerNumber+'</div>';
          ball.dataset.winnerNumber=winnerNumber;
          ball.classList.remove('spinning');
          ball.classList.add('active');
          resolve();
        }
      },120);
    });
  }

  async function drawNext() {
    if (isDrawing || availableNumbers.length===0) return;
    isDrawing=true;
    document.getElementById('drawBtn').disabled=true;

    let ballId='',place='';
    switch (currentStep) {
      case STEP_3RD: ballId='ball3'; place='third'; break;
      case STEP_2ND: ballId='ball2'; place='second'; break;
      case STEP_1ST: ballId='ball1'; place='first'; break;
    }

    const randIdx = Math.floor(Math.random() * availableNumbers.length);
    const winnerNumber = availableNumbers[randIdx];
    availableNumbers.splice(randIdx, 1);

    const ball = document.getElementById(ballId);
    await spinBall(ball, winnerNumber);

    // Show winner number on ball
    ball.innerHTML=`<div class="inner-text">${winnerNumber}</div>`;
    ball.dataset.winnerNumber=winnerNumber;

    // Add to winners list
    const listDiv=document.getElementById('winnersList');
    const div=document.createElement('div');
    div.className='winner-card '+place;
    div.innerHTML= `
      <div class="winner-position">${positions[place].emoji}</div>
      <div class="winner-details">
        <div class="winner-place">${positions[place].text}</div>
        <div class="winner-number">${winnerNumber}</div>
      </div>`;
    listDiv.prepend(div);

    if (currentStep===STEP_3RD) {
      showWinnersSection();
    }
    if (currentStep===STEP_1ST) {
      document.getElementById('congrats').style.display='block';
    }

    // Celebrate
    launchConfetti();

    // Move to next step
    currentStep++;
    if (currentStep > STEP_1ST) {
      // All winners drawn, show Reset button
      document.getElementById('drawBtn').style.display='none';
      document.getElementById('resetBtn').style.display='inline-block';
    } else {
      document.getElementById('drawBtn').disabled=false;
    }

    setTimeout(() => {
      clearConfetti();
      isDrawing=false;
    }, 2000);
  }

  // Confetti functions
  function launchConfetti() {
    const container = document.getElementById('confettiContainer');
    for (let i=0; i<30; i++) {
      createConfettiParticle(container);
    }
  }
  function createConfettiParticle(container) {
    const el = document.createElement('div');
    el.style.position='absolute';
    el.style.width='8px';
    el.style.height='8px';
    el.style.borderRadius='50%';
    el.style.backgroundColor=`hsl(${Math.random()*360}, 70%, 60%)`;
    el.style.top='0px';
    el.style.left=`${Math.random()*100}%`;
    el.style.opacity='1';
    el.style.transform=`translateY(0) rotate(${Math.random()*360}deg)`;
    el.style.transition='transform 2s ease-out, opacity 2s ease-out';

    setTimeout(() => {
      el.style.transform=`translateY(100vh) rotate(${Math.random()*360}deg)`;
      el.style.opacity='0';
    }, 50);
    setTimeout(() => {
      if (container.contains(el)) container.removeChild(el);
    }, 2100);
    container.appendChild(el);
  }
  function clearConfetti() {
    document.getElementById('confettiContainer').innerHTML='';
  }

  // Button event handlers
  document.getElementById('drawBtn').addEventListener('click', ()=> {
    if (availableNumbers.length > 0 && !isDrawing) {
      drawNext();
    }
  });
  document.getElementById('resetBtn').addEventListener('click', ()=> {
    initDraw();
    document.getElementById('drawBtn').style.display='inline-block';
    document.getElementById('resetBtn').style.display='none';
  });

  // Initialize on page load
  window.onload=()=> {
    initDraw();
  };
</script>
</body>
</html>
